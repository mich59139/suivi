<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi Communication ‚Äì Vizille en Mouvement</title>
    <meta name="description" content="Tableau de bord du suivi des actions de communication de la campagne Vizille en Mouvement">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --bleu-vizille: #1a3a5c;
            --bleu-clair: #2d5a87;
            --or: #c9a227;
            --or-clair: #e8c84a;
            --blanc-casse: #f8f6f1;
            --gris-doux: #e8e6e1;
            --gris-texte: #4a4a4a;
            --vert-fait: #27ae60;
            --orange-encours: #f39c12;
            --bleu-afaire: #3498db;
            --rouge-bloque: #e74c3c;
            --violet-haute: #9b59b6;
            
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.16);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Sans 3', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--blanc-casse);
            color: var(--gris-texte);
            line-height: 1.6;
        }
        
        /* ===== HEADER ===== */
        .header {
            background: linear-gradient(135deg, var(--bleu-vizille) 0%, var(--bleu-clair) 100%);
            color: white;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-icon {
            width: 120px;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-icon img {
            width: 100%;
            height: auto;
        }
        
        .logo-text h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .logo-text .slogan {
            font-size: 0.95rem;
            color: var(--or-clair);
            font-weight: 600;
        }
        
        .page-title {
            background: rgba(255,255,255,0.15);
            padding: 0.5rem 1.25rem;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.3);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* ===== STATS ===== */
        .stats-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1.25rem;
            justify-content: center;
        }
        
        .stat-chip {
            background: rgba(255,255,255,0.12);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .stat-chip:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .stat-chip.active {
            background: var(--or);
            color: var(--bleu-vizille);
            font-weight: 600;
        }
        
        .stat-number {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .stat-chip.afaire .stat-number { color: var(--bleu-afaire); }
        .stat-chip.encours .stat-number { color: var(--orange-encours); }
        .stat-chip.bloque .stat-number { color: var(--rouge-bloque); }
        .stat-chip.fait .stat-number { color: var(--vert-fait); }
        .stat-chip.haute .stat-number { color: var(--violet-haute); }
        .stat-chip.active .stat-number { color: var(--bleu-vizille); }
        
        /* ===== TOOLBAR ===== */
        .toolbar {
            max-width: 1200px;
            margin: 1.5rem auto;
            padding: 0 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            border: 2px solid var(--gris-doux);
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-family: inherit;
            background: white;
            transition: all 0.3s ease;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--bleu-vizille);
            box-shadow: 0 0 0 3px rgba(26, 58, 92, 0.1);
        }
        
        .search-box::before {
            content: 'üîç';
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            opacity: 0.5;
        }
        
        .filter-select {
            padding: 0.75rem 2rem 0.75rem 1rem;
            border: 2px solid var(--gris-doux);
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            font-family: inherit;
            background: white url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%234a4a4a' d='M6 8L1 3h10z'/%3E%3C/svg%3E") no-repeat right 0.75rem center;
            appearance: none;
            cursor: pointer;
            min-width: 140px;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: var(--bleu-vizille);
        }
        
        .view-toggle {
            display: flex;
            background: var(--gris-doux);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        .view-btn {
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.2s ease;
        }
        
        .view-btn.active {
            background: var(--bleu-vizille);
            color: white;
        }
        
        .btn-action {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--or) 0%, var(--or-clair) 100%);
            color: var(--bleu-vizille);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background: white;
            color: var(--bleu-vizille);
            border: 2px solid var(--gris-doux);
        }
        
        .btn-secondary:hover {
            border-color: var(--bleu-vizille);
        }
        
        .btn-github {
            background: #24292e;
            color: white;
            border: none;
        }
        
        .btn-github:hover {
            background: #1a1e22;
        }
        
        .btn-github.connected {
            background: var(--vert-fait);
        }
        
        .btn-github.syncing {
            background: var(--orange-encours);
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .github-modal {
            max-width: 500px;
        }
        
        .sync-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--bleu-vizille);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            display: none;
            align-items: center;
            gap: 0.5rem;
            z-index: 1000;
            font-weight: 500;
        }
        
        .sync-indicator.show {
            display: flex;
            animation: slideIn 0.3s ease;
        }
        
        .sync-indicator.success {
            background: var(--vert-fait);
        }
        
        .sync-indicator.error {
            background: var(--rouge-bloque);
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* ===== CARDS VIEW ===== */
        .cards-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.25rem;
        }
        
        .action-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--or);
        }
        
        .card-header {
            padding: 1rem 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .card-id {
            font-family: 'Playfair Display', serif;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--bleu-vizille);
            background: var(--gris-doux);
            padding: 0.25rem 0.6rem;
            border-radius: 6px;
        }
        
        .card-badges {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .badge {
            font-size: 0.75rem;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .badge-statut {
            color: white;
        }
        
        .badge-statut.afaire { background: var(--bleu-afaire); }
        .badge-statut.encours { background: var(--orange-encours); }
        .badge-statut.bloque { background: var(--rouge-bloque); }
        .badge-statut.fait { background: var(--vert-fait); }
        
        .badge-priorite {
            background: rgba(155, 89, 182, 0.15);
            color: var(--violet-haute);
        }
        
        .card-body {
            padding: 0 1.25rem 1rem;
        }
        
        .card-title {
            font-weight: 600;
            color: var(--bleu-vizille);
            margin-bottom: 0.5rem;
            font-size: 1rem;
            line-height: 1.4;
        }
        
        .card-description {
            font-size: 0.9rem;
            color: var(--gris-texte);
            opacity: 0.85;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .card-footer {
            padding: 0.75rem 1.25rem;
            background: var(--blanc-casse);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
        }
        
        .card-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gris-texte);
        }
        
        .card-axe {
            background: var(--bleu-vizille);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        /* ===== TABLE VIEW ===== */
        .table-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem 2rem;
            display: none;
        }
        
        .table-container.active {
            display: block;
        }
        
        .data-table {
            width: 100%;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: var(--bleu-vizille);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .data-table td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--gris-doux);
            vertical-align: middle;
        }
        
        .data-table tr {
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .data-table tbody tr:hover {
            background: rgba(201, 162, 39, 0.08);
        }
        
        .data-table .col-id { width: 90px; }
        .data-table .col-statut { width: 100px; }
        .data-table .col-priorite { width: 90px; }
        
        /* ===== MODAL ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 58, 92, 0.8);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 1rem;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: white;
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            transform: translateY(20px) scale(0.95);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--bleu-vizille) 0%, var(--bleu-clair) 100%);
            color: white;
            padding: 1.25rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .modal-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }
        
        .form-group {
            margin-bottom: 1.25rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: var(--bleu-vizille);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gris-doux);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--bleu-vizille);
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            background: var(--blanc-casse);
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .btn-delete {
            background: var(--rouge-bloque);
            color: white;
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }
        
        .btn-save {
            background: linear-gradient(135deg, var(--vert-fait) 0%, #2ecc71 100%);
            color: white;
        }
        
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-cancel {
            background: white;
            color: var(--gris-texte);
            border: 2px solid var(--gris-doux);
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            font-size: 0.95rem;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-section {
                flex-direction: column;
            }
            
            .toolbar {
                flex-direction: column;
            }
            
            .search-box {
                width: 100%;
            }
            
            .cards-container {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .modal-footer .btn-action {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* ===== EMPTY STATE ===== */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--gris-texte);
        }
        
        .empty-state-icon {
            font-size: 4rem;
            opacity: 0.3;
            margin-bottom: 1rem;
        }
        
        .empty-state h3 {
            font-family: 'Playfair Display', serif;
            color: var(--bleu-vizille);
            margin-bottom: 0.5rem;
        }
        
        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .action-card {
            animation: fadeInUp 0.4s ease backwards;
        }
        
        .action-card:nth-child(1) { animation-delay: 0.05s; }
        .action-card:nth-child(2) { animation-delay: 0.1s; }
        .action-card:nth-child(3) { animation-delay: 0.15s; }
        .action-card:nth-child(4) { animation-delay: 0.2s; }
        .action-card:nth-child(5) { animation-delay: 0.25s; }
        .action-card:nth-child(6) { animation-delay: 0.3s; }
        
        /* Chart */
        .chart-section {
            max-width: 1200px;
            margin: 0 auto 1.5rem;
            padding: 0 1rem;
        }
        
        .chart-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            padding: 1.5rem;
        }
        
        .chart-card h3 {
            font-family: 'Playfair Display', serif;
            color: var(--bleu-vizille);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .chart-container {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .chart-wrapper {
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            margin: 0 auto;
        }
        
        .chart-legend {
            flex: 1;
            min-width: 200px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .legend-item:hover {
            background: var(--blanc-casse);
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        
        .legend-label {
            flex: 1;
            font-weight: 500;
        }
        
        .legend-value {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--bleu-vizille);
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-content">
            <div class="header-top">
                <div class="logo-section">
                    <div class="logo-icon">
                        <img src="https://raw.githubusercontent.com/mich59139/Vizille-en-mouvement2/main/images/logo.png" alt="Vizille en Mouvement">
                    </div>
                    <div class="logo-text">
                        <h1>Vizille en Mouvement</h1>
                        <div class="slogan">Ensemble pour une ville dynamique et solidaire</div>
                    </div>
                </div>
                <div class="page-title">
                    <span>üìã</span>
                    <span>Suivi Communication</span>
                </div>
            </div>
            
            <div class="stats-bar" id="stats-bar"></div>
        </div>
    </header>
    
    <!-- TOOLBAR -->
    <div class="toolbar">
        <div class="search-box">
            <input type="text" id="search-input" placeholder="Rechercher une action...">
        </div>
        
        <select class="filter-select" id="filter-responsable">
            <option value="">Tous responsables</option>
        </select>
        
        <select class="filter-select" id="filter-axe">
            <option value="">Tous les axes</option>
        </select>
        
        <div class="view-toggle">
            <button class="view-btn active" data-view="cards" title="Vue cartes">üÉè</button>
            <button class="view-btn" data-view="table" title="Vue tableau">üìä</button>
        </div>
        
        <button class="btn-action btn-primary" id="btn-new">
            <span>‚ûï</span>
            <span>Nouvelle</span>
        </button>
        
        <button class="btn-action btn-secondary" id="btn-export">
            <span>üì•</span>
            <span>Export</span>
        </button>
        
        <button class="btn-action btn-secondary" id="btn-import">
            <span>üì§</span>
            <span>Import</span>
        </button>
        <input type="file" id="import-file" accept=".json" style="display:none">
        
        <button class="btn-action btn-github" id="btn-github" title="Configuration GitHub">
            <span>‚öôÔ∏è</span>
            <span id="github-status">GitHub</span>
        </button>
    </div>
    
    <!-- GITHUB CONFIG MODAL -->
    <div class="modal-overlay" id="github-modal-overlay">
        <div class="modal github-modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Configuration GitHub</h2>
                <button class="modal-close" id="github-modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 1rem; color: var(--gris-texte);">
                    Connectez le tableau √† GitHub pour synchroniser automatiquement les donn√©es avec l'√©quipe.
                </p>
                
                <div class="form-group">
                    <label for="github-token">Token GitHub (Personal Access Token)</label>
                    <input type="password" id="github-token" placeholder="ghp_xxxxxxxxxxxx">
                    <small style="color: #888; font-size: 0.85rem;">Cr√©ez un token sur GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens</small>
                </div>
                
                <div class="form-group">
                    <label>Repository</label>
                    <input type="text" value="mich59139/suivi" readonly style="background: #f0f0f0;">
                </div>
                
                <div class="form-group">
                    <label>Fichier de donn√©es</label>
                    <input type="text" value="data/communication.json" readonly style="background: #f0f0f0;">
                </div>
                
                <div id="github-connection-status" style="margin: 1rem 0; padding: 0.75rem; border-radius: 8px; display: none;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" id="github-disconnect">D√©connecter</button>
                <button type="button" class="btn-action btn-save" id="github-test">Tester</button>
                <button type="button" class="btn-action btn-save" id="github-save-config" style="background: var(--vert-fait);">Sauvegarder</button>
            </div>
        </div>
    </div>
    
    <!-- CHART SECTION -->
    <div class="chart-section">
        <div class="chart-card">
            <h3>üìä R√©partition des actions</h3>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <canvas id="statusChart"></canvas>
                </div>
                <div class="chart-legend" id="chart-legend"></div>
            </div>
        </div>
    </div>
    
    <!-- CARDS VIEW -->
    <div class="cards-container" id="cards-container"></div>
    
    <!-- TABLE VIEW -->
    <div class="table-container" id="table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th class="col-id">ID</th>
                    <th>T√¢che</th>
                    <th>Responsable</th>
                    <th class="col-statut">Statut</th>
                    <th class="col-priorite">Priorit√©</th>
                    <th>Axe</th>
                </tr>
            </thead>
            <tbody id="table-body"></tbody>
        </table>
    </div>
    
    <!-- MODAL -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2><span id="modal-icon">üìù</span> <span id="modal-title">Modifier l'action</span></h2>
                <button class="modal-close" id="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <form id="action-form">
                    <input type="hidden" id="form-id">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="form-axe">Axe / Outil</label>
                            <select id="form-axe">
                                <option value="Site web">Site web</option>
                                <option value="R√©seaux sociaux">R√©seaux sociaux</option>
                                <option value="Supports papier">Supports papier</option>
                                <option value="√âv√©nementiel">√âv√©nementiel</option>
                                <option value="Presse">Presse</option>
                                <option value="Email">Email</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="form-categorie">Cat√©gorie</label>
                            <input type="text" id="form-categorie" placeholder="Ex: Cr√©ation, Publication...">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="form-tache">T√¢che</label>
                        <input type="text" id="form-tache" placeholder="Intitul√© de la t√¢che" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="form-description">Description</label>
                        <textarea id="form-description" placeholder="D√©tails de l'action..."></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="form-responsable">Responsable</label>
                            <select id="form-responsable">
                                <option value="Michel">Michel</option>
                                <option value="Laurent">Laurent</option>
                                <option value="Catherine">Catherine</option>
                                <option value="√âquipe">√âquipe</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="form-statut">Statut</label>
                            <select id="form-statut">
                                <option value="√Ä faire">√Ä faire</option>
                                <option value="En cours">En cours</option>
                                <option value="Bloqu√©">Bloqu√©</option>
                                <option value="Fait">Fait</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="form-priorite">Priorit√©</label>
                            <select id="form-priorite">
                                <option value="Basse">Basse</option>
                                <option value="Moyenne">Moyenne</option>
                                <option value="Haute">Haute</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="form-echeance">√âch√©ance</label>
                            <input type="date" id="form-echeance">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-action btn-delete" id="btn-delete" style="display:none">
                    <span>üóëÔ∏è</span>
                    <span>Supprimer</span>
                </button>
                <div style="flex:1"></div>
                <button class="btn-cancel" id="btn-cancel">Annuler</button>
                <button class="btn-action btn-save" id="btn-save">
                    <span>‚úì</span>
                    <span>Enregistrer</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Indicateur de synchronisation -->
    <div class="sync-indicator" id="sync-indicator">
        <span id="sync-icon">üîÑ</span>
        <span id="sync-text">Synchronisation...</span>
    </div>
    
    <script>
        // ===== CONFIGURATION GITHUB =====
        const GITHUB_REPO = 'mich59139/suivi';
        const GITHUB_FILE = 'data/communication.json';
        const GITHUB_BRANCH = 'main';
        
        // ===== DONN√âES =====
        const defaultData = [
            { id: "COM-001", axe: "Site web", categorie: "Infrastructure", tache: "Mise en place h√©bergement", description: "Configuration serveur et nom de domaine vizillenmouvement.fr", responsable: "Michel", statut: "Fait", priorite: "Haute", echeance: "2025-01-15" },
            { id: "COM-002", axe: "Site web", categorie: "D√©veloppement", tache: "Page d'accueil", description: "Cr√©ation de la landing page avec pr√©sentation de la candidate et du projet", responsable: "Michel", statut: "Fait", priorite: "Haute", echeance: "2025-01-20" },
            { id: "COM-003", axe: "Site web", categorie: "Contenu", tache: "Bilan du mandat", description: "Int√©gration du tableau de bord interactif des 271 actions", responsable: "Michel", statut: "Fait", priorite: "Haute", echeance: "2025-02-01" },
            { id: "COM-004", axe: "Site web", categorie: "Contenu", tache: "√âquipe de campagne", description: "Photos et pr√©sentations des membres de l'√©quipe", responsable: "Michel", statut: "En cours", priorite: "Moyenne", echeance: "2025-02-15" },
            { id: "COM-005", axe: "R√©seaux sociaux", categorie: "Organisation", tache: "Coordination FB/Site", description: "Guide de synchronisation entre publications Facebook et site web", responsable: "Laurent", statut: "√Ä faire", priorite: "Moyenne", echeance: "2025-02-10" },
            { id: "COM-006", axe: "R√©seaux sociaux", categorie: "Contenu", tache: "Planning √©ditorial", description: "Calendrier des publications pour les 6 prochains mois", responsable: "Laurent", statut: "En cours", priorite: "Haute", echeance: "2025-02-05" },
            { id: "COM-007", axe: "Supports papier", categorie: "Cr√©ation", tache: "Tract de pr√©sentation", description: "Flyer A5 recto-verso avec QR code vers le site", responsable: "√âquipe", statut: "√Ä faire", priorite: "Haute", echeance: "2025-03-01" },
            { id: "COM-008", axe: "Supports papier", categorie: "Cr√©ation", tache: "Affiche officielle", description: "Affiche de campagne format A3 et A2", responsable: "√âquipe", statut: "√Ä faire", priorite: "Moyenne", echeance: "2025-04-01" },
            { id: "COM-009", axe: "Site web", categorie: "Fonctionnalit√©", tache: "Questions citoyens", description: "Module de questions/r√©ponses avec les habitants", responsable: "Michel", statut: "Fait", priorite: "Moyenne", echeance: "2025-02-20" },
            { id: "COM-010", axe: "Site web", categorie: "Contenu", tache: "Blog actualit√©s", description: "Section actualit√©s avec articles de campagne", responsable: "Michel", statut: "Fait", priorite: "Moyenne", echeance: "2025-02-25" },
            { id: "COM-011", axe: "√âv√©nementiel", categorie: "Organisation", tache: "R√©unions publiques", description: "Planning et communication des r√©unions de quartier", responsable: "Catherine", statut: "√Ä faire", priorite: "Haute", echeance: "2025-03-15" },
            { id: "COM-012", axe: "Email", categorie: "Infrastructure", tache: "Newsletter", description: "Mise en place d'un syst√®me d'inscription et d'envoi", responsable: "Michel", statut: "√Ä faire", priorite: "Basse", echeance: "2025-04-01" },
            { id: "COM-013", axe: "Site web", categorie: "Contenu", tache: "Programme 2026-2032", description: "Pr√©sentation d√©taill√©e du projet municipal", responsable: "√âquipe", statut: "√Ä faire", priorite: "Haute", echeance: "2025-05-01" },
            { id: "COM-014", axe: "Presse", categorie: "Relations", tache: "Dossier de presse", description: "Kit m√©dia avec photos HD et communiqu√©s", responsable: "Catherine", statut: "√Ä faire", priorite: "Moyenne", echeance: "2025-04-15" },
            { id: "COM-015", axe: "Site web", categorie: "Technique", tache: "Optimisation SEO", description: "R√©f√©rencement naturel et meta tags", responsable: "Michel", statut: "En cours", priorite: "Moyenne", echeance: "2025-03-01" },
            { id: "COM-016", axe: "R√©seaux sociaux", categorie: "Contenu", tache: "Vid√©os t√©moignages", description: "T√©moignages d'habitants sur les r√©alisations", responsable: "Laurent", statut: "√Ä faire", priorite: "Moyenne", echeance: "2025-04-01" },
            { id: "COM-017", axe: "Site web", categorie: "Administration", tache: "Interface admin", description: "Panneau d'administration pour mise √† jour autonome", responsable: "Michel", statut: "Fait", priorite: "Haute", echeance: "2025-02-28" }
        ];
        
        let actions = JSON.parse(localStorage.getItem('vizille_actions')) || defaultData;
        let filteredActions = [...actions];
        let currentView = 'cards';
        let editingId = null;
        let githubSha = null;
        
        // ===== FONCTIONS GITHUB =====
        function getGithubToken() { return localStorage.getItem('github_token') || ''; }
        function setGithubToken(token) { token ? localStorage.setItem('github_token', token) : localStorage.removeItem('github_token'); updateGithubStatus(); }
        function isGithubConnected() { return !!getGithubToken(); }
        
        function updateGithubStatus() {
            const btn = document.getElementById('btn-github');
            const status = document.getElementById('github-status');
            if (isGithubConnected()) { btn.classList.add('connected'); status.textContent = '‚úì GitHub'; }
            else { btn.classList.remove('connected'); status.textContent = 'GitHub'; }
        }
        
        function showSyncIndicator(message, type = 'info') {
            const indicator = document.getElementById('sync-indicator');
            indicator.className = 'sync-indicator show ' + type;
            document.getElementById('sync-icon').textContent = type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : 'üîÑ';
            document.getElementById('sync-text').textContent = message;
            setTimeout(() => indicator.classList.remove('show'), 3000);
        }
        
        async function loadFromGitHub() {
            const token = getGithubToken();
            if (!token) return false;
            try {
                showSyncIndicator('Chargement depuis GitHub...');
                const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`, {
                    headers: { 'Authorization': `token ${token}`, 'Accept': 'application/vnd.github.v3+json' }
                });
                if (response.status === 404) { showSyncIndicator('Fichier non trouv√©, cr√©ation...', 'info'); return false; }
                if (!response.ok) throw new Error(`Erreur: ${response.status}`);
                const data = await response.json();
                githubSha = data.sha;
                actions = JSON.parse(atob(data.content));
                localStorage.setItem('vizille_actions', JSON.stringify(actions));
                showSyncIndicator('Donn√©es charg√©es', 'success');
                return true;
            } catch (error) { console.error(error); showSyncIndicator('Erreur chargement', 'error'); return false; }
        }
        
        async function saveToGitHub() {
            const token = getGithubToken();
            if (!token) return false;
            try {
                document.getElementById('btn-github').classList.add('syncing');
                showSyncIndicator('Synchronisation...');
                if (!githubSha) {
                    try {
                        const r = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`, { headers: { 'Authorization': `token ${token}`, 'Accept': 'application/vnd.github.v3+json' } });
                        if (r.ok) githubSha = (await r.json()).sha;
                    } catch(e) {}
                }
                const body = { message: `MAJ communication - ${new Date().toLocaleString('fr-FR')}`, content: btoa(unescape(encodeURIComponent(JSON.stringify(actions, null, 2)))), branch: GITHUB_BRANCH };
                if (githubSha) body.sha = githubSha;
                const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}/contents/${GITHUB_FILE}`, {
                    method: 'PUT', headers: { 'Authorization': `token ${token}`, 'Accept': 'application/vnd.github.v3+json', 'Content-Type': 'application/json' }, body: JSON.stringify(body)
                });
                if (!response.ok) throw new Error((await response.json()).message);
                githubSha = (await response.json()).content.sha;
                document.getElementById('btn-github').classList.remove('syncing');
                showSyncIndicator('Synchronis√© ‚úì', 'success');
                return true;
            } catch (error) { document.getElementById('btn-github').classList.remove('syncing'); showSyncIndicator('Erreur: ' + error.message, 'error'); return false; }
        }
        
        async function testGithubConnection() {
            const token = document.getElementById('github-token').value;
            const statusDiv = document.getElementById('github-connection-status');
            if (!token) { statusDiv.style.display = 'block'; statusDiv.style.background = '#fee'; statusDiv.style.color = '#c00'; statusDiv.textContent = '‚ùå Entrez un token'; return; }
            statusDiv.style.display = 'block'; statusDiv.style.background = '#ffe'; statusDiv.style.color = '#860'; statusDiv.textContent = '‚è≥ Test en cours...';
            try {
                const r = await fetch(`https://api.github.com/repos/${GITHUB_REPO}`, { headers: { 'Authorization': `token ${token}`, 'Accept': 'application/vnd.github.v3+json' } });
                if (r.ok) { statusDiv.style.background = '#efe'; statusDiv.style.color = '#080'; statusDiv.textContent = '‚úÖ Connexion r√©ussie !'; }
                else { statusDiv.style.background = '#fee'; statusDiv.style.color = '#c00'; statusDiv.textContent = r.status === 401 ? '‚ùå Token invalide' : '‚ùå Erreur ' + r.status; }
            } catch (e) { statusDiv.style.background = '#fee'; statusDiv.style.color = '#c00'; statusDiv.textContent = '‚ùå ' + e.message; }
        }
        
        // ===== UTILITAIRES =====
        async function saveData() { localStorage.setItem('vizille_actions', JSON.stringify(actions)); if (isGithubConnected()) await saveToGitHub(); }
        function getStatutClass(s) { return { '√Ä faire': 'afaire', 'En cours': 'encours', 'Bloqu√©': 'bloque', 'Fait': 'fait' }[s] || 'afaire'; }
        function getNextId() { const nums = actions.map(a => parseInt(a.id.replace('COM-', ''))).filter(n => !isNaN(n)); return `COM-${String((nums.length ? Math.max(...nums) : 0) + 1).padStart(3, '0')}`; }
        
        // ===== STATS & CHART =====
        let statusChart = null;
        function updateChart() {
            const counts = { afaire: actions.filter(a => a.statut === '√Ä faire').length, encours: actions.filter(a => a.statut === 'En cours').length, bloque: actions.filter(a => a.statut === 'Bloqu√©').length, fait: actions.filter(a => a.statut === 'Fait').length };
            const ctx = document.getElementById('statusChart').getContext('2d');
            if (statusChart) statusChart.destroy();
            statusChart = new Chart(ctx, { type: 'doughnut', data: { labels: ['√Ä faire', 'En cours', 'Bloqu√©', 'Fait'], datasets: [{ data: [counts.afaire, counts.encours, counts.bloque, counts.fait], backgroundColor: ['#3498db', '#f39c12', '#e74c3c', '#27ae60'], borderWidth: 0, hoverOffset: 8 }] }, options: { responsive: true, maintainAspectRatio: true, cutout: '60%', plugins: { legend: { display: false } } } });
            document.getElementById('chart-legend').innerHTML = [{ l: '√Ä faire', v: counts.afaire, c: '#3498db' }, { l: 'En cours', v: counts.encours, c: '#f39c12' }, { l: 'Bloqu√©', v: counts.bloque, c: '#e74c3c' }, { l: 'Fait', v: counts.fait, c: '#27ae60' }].map(i => `<div class="legend-item" data-filter="${i.l}"><div class="legend-color" style="background:${i.c}"></div><span class="legend-label">${i.l}</span><span class="legend-value">${i.v}</span></div>`).join('');
            document.querySelectorAll('.legend-item').forEach(item => item.addEventListener('click', () => { filteredActions = actions.filter(a => a.statut === item.dataset.filter); renderView(); }));
        }
        
        function updateStats() {
            const t = actions.length, af = actions.filter(a => a.statut === '√Ä faire').length, ec = actions.filter(a => a.statut === 'En cours').length, bl = actions.filter(a => a.statut === 'Bloqu√©').length, fa = actions.filter(a => a.statut === 'Fait').length, ha = actions.filter(a => a.priorite === 'Haute').length;
            document.getElementById('stats-bar').innerHTML = `<div class="stat-chip" data-filter="all"><span class="stat-number">${t}</span><span>Total</span></div><div class="stat-chip afaire" data-filter="√Ä faire"><span class="stat-number">${af}</span><span>√Ä faire</span></div><div class="stat-chip encours" data-filter="En cours"><span class="stat-number">${ec}</span><span>En cours</span></div><div class="stat-chip bloque" data-filter="Bloqu√©"><span class="stat-number">${bl}</span><span>Bloqu√©</span></div><div class="stat-chip fait" data-filter="Fait"><span class="stat-number">${fa}</span><span>Fait</span></div><div class="stat-chip haute" data-filter="Haute"><span class="stat-number">${ha}</span><span>Priorit√© haute</span></div>`;
            document.querySelectorAll('.stat-chip').forEach(chip => chip.addEventListener('click', () => { const f = chip.dataset.filter; document.querySelectorAll('.stat-chip').forEach(c => c.classList.remove('active')); filteredActions = f === 'all' ? [...actions] : f === 'Haute' ? actions.filter(a => a.priorite === 'Haute') : actions.filter(a => a.statut === f); if (f !== 'all') chip.classList.add('active'); renderView(); }));
        }
        
        // ===== FILTRES =====
        function populateFilters() {
            document.getElementById('filter-responsable').innerHTML = '<option value="">Tous responsables</option>' + [...new Set(actions.map(a => a.responsable))].sort().map(r => `<option value="${r}">${r}</option>`).join('');
            document.getElementById('filter-axe').innerHTML = '<option value="">Tous les axes</option>' + [...new Set(actions.map(a => a.axe))].sort().map(a => `<option value="${a}">${a}</option>`).join('');
        }
        
        function applyFilters() {
            const s = document.getElementById('search-input').value.toLowerCase(), r = document.getElementById('filter-responsable').value, x = document.getElementById('filter-axe').value;
            filteredActions = actions.filter(a => (!s || a.tache.toLowerCase().includes(s) || a.description.toLowerCase().includes(s) || a.id.toLowerCase().includes(s)) && (!r || a.responsable === r) && (!x || a.axe === x));
            document.querySelectorAll('.stat-chip').forEach(c => c.classList.remove('active'));
            renderView();
        }
        
        // ===== RENDU =====
        function renderView() { currentView === 'cards' ? (renderCards(), document.getElementById('cards-container').style.display = 'grid', document.getElementById('table-container').classList.remove('active')) : (renderTable(), document.getElementById('cards-container').style.display = 'none', document.getElementById('table-container').classList.add('active')); }
        
        function renderCards() {
            const c = document.getElementById('cards-container');
            if (!filteredActions.length) { c.innerHTML = '<div class="empty-state" style="grid-column:1/-1"><div class="empty-state-icon">üì≠</div><h3>Aucune action</h3></div>'; return; }
            c.innerHTML = filteredActions.map(a => `<div class="action-card" data-id="${a.id}"><div class="card-header"><span class="card-id">${a.id}</span><div class="card-badges"><span class="badge badge-statut ${getStatutClass(a.statut)}">${a.statut}</span>${a.priorite === 'Haute' ? '<span class="badge badge-priorite">‚ö° Haute</span>' : ''}</div></div><div class="card-body"><div class="card-title">${a.tache}</div><div class="card-description">${a.description || ''}</div></div><div class="card-footer"><div class="card-meta"><span>üë§</span><span>${a.responsable}</span></div><span class="card-axe">${a.axe}</span></div></div>`).join('');
            c.querySelectorAll('.action-card').forEach(card => card.addEventListener('click', () => openModal(card.dataset.id)));
        }
        
        function renderTable() {
            const b = document.getElementById('table-body');
            if (!filteredActions.length) { b.innerHTML = '<tr><td colspan="6" class="empty-state"><div class="empty-state-icon">üì≠</div><h3>Aucune action</h3></td></tr>'; return; }
            b.innerHTML = filteredActions.map(a => `<tr data-id="${a.id}"><td><span class="card-id">${a.id}</span></td><td><strong>${a.tache}</strong></td><td>${a.responsable}</td><td><span class="badge badge-statut ${getStatutClass(a.statut)}">${a.statut}</span></td><td>${a.priorite === 'Haute' ? '‚ö° ' : ''}${a.priorite}</td><td><span class="card-axe">${a.axe}</span></td></tr>`).join('');
            b.querySelectorAll('tr').forEach(row => row.addEventListener('click', () => openModal(row.dataset.id)));
        }
        
        // ===== MODAL =====
        function openModal(id = null) {
            editingId = id;
            const del = document.getElementById('btn-delete');
            if (id) {
                const a = actions.find(x => x.id === id); if (!a) return;
                document.getElementById('modal-icon').textContent = 'üìù'; document.getElementById('modal-title').textContent = `Modifier ${a.id}`;
                document.getElementById('form-id').value = a.id; document.getElementById('form-axe').value = a.axe; document.getElementById('form-categorie').value = a.categorie || ''; document.getElementById('form-tache').value = a.tache; document.getElementById('form-description').value = a.description || ''; document.getElementById('form-responsable').value = a.responsable; document.getElementById('form-statut').value = a.statut; document.getElementById('form-priorite').value = a.priorite; document.getElementById('form-echeance').value = a.echeance || '';
                del.style.display = 'flex';
            } else {
                document.getElementById('modal-icon').textContent = '‚ûï'; document.getElementById('modal-title').textContent = 'Nouvelle action';
                document.getElementById('form-id').value = getNextId(); document.getElementById('form-axe').value = 'Site web'; document.getElementById('form-categorie').value = ''; document.getElementById('form-tache').value = ''; document.getElementById('form-description').value = ''; document.getElementById('form-responsable').value = 'Michel'; document.getElementById('form-statut').value = '√Ä faire'; document.getElementById('form-priorite').value = 'Moyenne'; document.getElementById('form-echeance').value = '';
                del.style.display = 'none';
            }
            document.getElementById('modal-overlay').classList.add('active');
        }
        
        function closeModal() { document.getElementById('modal-overlay').classList.remove('active'); editingId = null; }
        
        function saveAction() {
            const d = { id: document.getElementById('form-id').value, axe: document.getElementById('form-axe').value, categorie: document.getElementById('form-categorie').value, tache: document.getElementById('form-tache').value, description: document.getElementById('form-description').value, responsable: document.getElementById('form-responsable').value, statut: document.getElementById('form-statut').value, priorite: document.getElementById('form-priorite').value, echeance: document.getElementById('form-echeance').value };
            if (!d.tache.trim()) { alert('Saisissez une t√¢che'); return; }
            if (editingId) { const i = actions.findIndex(a => a.id === editingId); if (i !== -1) actions[i] = d; } else actions.push(d);
            saveData(); populateFilters(); updateStats(); updateChart(); applyFilters(); closeModal();
        }
        
        function deleteAction() { if (!editingId || !confirm(`Supprimer ${editingId} ?`)) return; actions = actions.filter(a => a.id !== editingId); saveData(); populateFilters(); updateStats(); updateChart(); applyFilters(); closeModal(); }
        
        // ===== EXPORT / IMPORT (corrig√© pour Safari) =====
        function exportData() {
            const jsonStr = JSON.stringify(actions, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(jsonStr);
            const a = document.createElement('a');
            a.href = dataUri;
            a.download = `suivi-communication-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
        
        function importData(e) { const f = e.target.files[0]; if (!f) return; const r = new FileReader(); r.onload = ev => { try { const d = JSON.parse(ev.target.result); if (Array.isArray(d) && confirm(`Importer ${d.length} actions ?`)) { actions = d; saveData(); populateFilters(); updateStats(); updateChart(); applyFilters(); alert('Import r√©ussi !'); } } catch(err) { alert('Erreur fichier'); } }; r.readAsText(f); e.target.value = ''; }
        
        // ===== INIT =====
        async function init() {
            updateGithubStatus();
            if (isGithubConnected()) { const ok = await loadFromGitHub(); if (ok) filteredActions = [...actions]; }
            populateFilters(); updateStats(); updateChart(); renderView();
            
            // Event listeners
            document.getElementById('search-input').addEventListener('input', applyFilters);
            document.getElementById('filter-responsable').addEventListener('change', applyFilters);
            document.getElementById('filter-axe').addEventListener('change', applyFilters);
            document.querySelectorAll('.view-btn').forEach(b => b.addEventListener('click', () => { document.querySelectorAll('.view-btn').forEach(x => x.classList.remove('active')); b.classList.add('active'); currentView = b.dataset.view; renderView(); }));
            document.getElementById('btn-new').addEventListener('click', () => openModal());
            document.getElementById('modal-close').addEventListener('click', closeModal);
            document.getElementById('btn-cancel').addEventListener('click', closeModal);
            document.getElementById('btn-save').addEventListener('click', saveAction);
            document.getElementById('btn-delete').addEventListener('click', deleteAction);
            document.getElementById('modal-overlay').addEventListener('click', e => { if (e.target === document.getElementById('modal-overlay')) closeModal(); });
            document.getElementById('btn-export').addEventListener('click', exportData);
            document.getElementById('btn-import').addEventListener('click', () => document.getElementById('import-file').click());
            document.getElementById('import-file').addEventListener('change', importData);
            
            // GitHub
            document.getElementById('btn-github').addEventListener('click', () => { document.getElementById('github-token').value = getGithubToken(); document.getElementById('github-connection-status').style.display = 'none'; document.getElementById('github-modal-overlay').classList.add('active'); });
            document.getElementById('github-modal-close').addEventListener('click', () => document.getElementById('github-modal-overlay').classList.remove('active'));
            document.getElementById('github-modal-overlay').addEventListener('click', e => { if (e.target === document.getElementById('github-modal-overlay')) document.getElementById('github-modal-overlay').classList.remove('active'); });
            document.getElementById('github-test').addEventListener('click', testGithubConnection);
            document.getElementById('github-save-config').addEventListener('click', async () => { const t = document.getElementById('github-token').value; setGithubToken(t); document.getElementById('github-modal-overlay').classList.remove('active'); if (t) { const ok = await loadFromGitHub(); if (ok) { filteredActions = [...actions]; populateFilters(); updateStats(); updateChart(); renderView(); } } });
            document.getElementById('github-disconnect').addEventListener('click', () => { setGithubToken(''); document.getElementById('github-token').value = ''; document.getElementById('github-connection-status').style.display = 'none'; showSyncIndicator('D√©connect√©', 'info'); });
            
            // Raccourcis clavier
            document.addEventListener('keydown', e => { if (e.key === 'Escape') { closeModal(); document.getElementById('github-modal-overlay').classList.remove('active'); } if (e.ctrlKey && e.key === 'n') { e.preventDefault(); openModal(); } });
        }
        
        init();
    </script>
</body>
</html>
